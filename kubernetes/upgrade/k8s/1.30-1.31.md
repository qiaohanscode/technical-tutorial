### 1 Download the public signing key for the Kubernetes package repositories.
```
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.31/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
```

### 2 Add the appropriate k8s ``apt`` repository
```
echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list
```

### 3 Update `apt` package index
```
sudo apt update
sudo apt-cache madison kubeamd
```

### Upgrade kubeadm
```
sudo apt-mark unhold kubeadm && \
sudo apt-get update && sudo apt-get install -y kubeadm='1.31.14-1.1' && \
sudo apt-mark hold kubeadm
```

### 5. Verify Kubeadm Version
```
kubeadm version
```

### 6. Verify the updgrade plan
```
sudo kubeadm upgrade plan
```

### 7. start the upgrade
```
sudo kubeadm upgrade apply v1.31.14
```

### 8. Drain the master node
```
kubectl drain ekl-k8s-master-1.ponyworld.io --ignore-daemonsets
```

### 9. Upgrade kubelet und kubectl
```
sudo apt-mark unhold kubelet kubectl && \
sudo apt-get update && sudo apt-get install -y kubelet='1.31.14-1.1' kubectl='1.31.14-1.1' && \
sudo apt-mark hold kubelet kubectl
```

### 10. Restart kubelet 
```
sudo systemctl daemon-reload
sudo systemctl restart kubelet
```

### 11. Uncordon the master node -- bring the master node online
```
kubectl uncordon ekl-k8s-master-1.ponyworld.io
```

## Upgrade Work 1 & 2
### 1 Download the public signing key for the Kubernetes package repositories.
```
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.31/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
```

### 2 Add the appropriate k8s ``apt`` repository
```
echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.31/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list
```

### 3. Find the latest version 
```
sudo apt update
sudo apt-cache madison kubeadm
```

### 4. Upgrade kubeadm on the worker node
```
sudo apt-mark unhold kubeadm && \
sudo apt-get update && sudo apt-get install -y kubeadm='1.31.14-1.1' && \
sudo apt-mark hold kubeadm
```

### 5. Upgrades the local kubelet configuration of worker node
```
sudo kubeadm upgrade node
```

### 6. Drain the worker node -- execute the command on master node
```
kubectl drain ekl-k8s-worker-1.ponyworld.io --ignore-daemonsets
```

### 7. Upgrade kubelet and kubectl
```
sudo apt-mark unhold kubelet kubectl && \
sudo apt-get update && sudo apt-get install -y kubelet='1.31.14-1.1' kubectl='1.31.14-1.1' && \
sudo apt-mark hold kubelet kubectl
```

### 8. Restart the kubelet
```
sudo systemctl daemon-reload
sudo systemctl restart kubelet
```

### 9. Uncordon the worker node-- Bring the node back online by marking it schedulable, execute on master node!
```
# execute the command on master node
kubectl uncordon ekl-k8s-worker-1.ponyworld.io
```