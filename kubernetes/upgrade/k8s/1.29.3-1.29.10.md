## Upgrade Control plant
### 1. Find the latest verion 
```
sudo apt update
sudo apt-cache madison kubeadm
```

### 2. Upgrade kubeadm:
```
sudo apt-mark unhold kubeadm && \
sudo apt-get update && sudo apt-get install -y kubeadm='1.29.10-1.1' && \
sudo apt-mark hold kubeadm
```

### 3. Verify that the download works and has the expected version:
```
kubeadm version
```

### 4. Verify the upgrade plan:
```
sudo kubeadm upgrade plan
```

### Upgrade to 1.29.15
```
sudo apt-mark unhold kubeadm && \
sudo apt-get update && sudo apt-get install -y kubeadm='1.29.15' && \
sudo apt-mark hold kubeadm
```
`Note: ` Upgrade to 1.29.15 is not possible becaus kubeadm 1.29.15 is not available in repository.

### 5. execute the upgrade
```
sudo kubeadm upgrade apply v1.29.10-1.1
```

### 6. Manually upgrade your CNI provider plugin.

### 7. Drain the master node
```
kubectl drain ekl-k8s-master-1.ponyworld.io --ignore-daemonsets
```

### 8. Upgrade the kubelet and kubectl
```
sudo apt-mark unhold kubelet kubectl && \
sudo apt-get update && sudo apt-get install -y kubelet='1.29.10' kubectl='1.29.10' && \
sudo apt-mark hold kubelet kubectl
```

### 9. Restart the kubelet
```
sudo systemctl daemon-reload
sudo systemctl restart kubelet
```

### 10. Bring the master node back online by marking it schedulable
```
kubectl uncordon ekl-k8s-master-1.ponyworld.io
```

## Upgrade Worker 1
### Update Ubuntu
```
sudo apt update
sudo apt list --upgradable
sudo apt full-upgrade
sudo apt-cache madison kubeadm kubelet kubectl
```

### Upgrade kubeadm on the worker node
```
sudo apt-mark unhold kubeadm && \
sudo apt-get update && sudo apt-get install -y kubeadm='1.29.10-1.1' && \
sudo apt-mark hold kubeadm
```

### Upgrades the local kubelet configuration of worker node 
```
sudo kubeadm upgrade node
```

### Drain the worker node -- execute the command on master node
```
kubectl drain ekl-k8s-worker-1.ponyworld.io --ignore-daemonsets
```

### Upgrade kubelet and kubectl
```
sudo apt-mark unhold kubelet kubectl && \
sudo apt-get update && sudo apt-get install -y kubelet='1.29.10-1.1' kubectl='1.29.1-1.1' && \
sudo apt-mark hold kubelet kubectl
```

### Restart the kubelet
```
sudo systemctl daemon-reload
sudo systemctl restart kubelet
```

### Uncordon the worker node-- Bring the node back online by marking it schedulable
```
# execute the command on master node
kubectl uncordon ekl-k8s-worker-1.ponyworld.io
```